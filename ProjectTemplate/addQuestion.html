<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <!--DO NOT FORGET THIS SCRIPT TAG SO YOU CAN USE JQUERY!!!!!-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
    <script type="text/javascript">
        function SendQuestions(q1, q2, q3, q4, q5) {
            let webMethod = "ProjectServices.asmx/InsertSurvey";
            let parameters = "{\"q1\":\"" + encodeURI(q1) + "\"," + "\"q2\":\"" + encodeURI(q2) + "\"," + "\"q3\":\"" + encodeURI(q3) + "\"," + "\"q4\":\"" + encodeURI(q4) + "\"," + "\"q5\":\"" + encodeURI(q5) + "\" }";

            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    // set boolean from web method to a local variable representing the response
                    let responseFromServer = msg.d;
                    alert("Survey has been saved to database.");
                },
                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                }
            });
        }

        //hhinker script for question page code
        let questions = [];

        // counter variable
        let counter = 0;

        const addQuestion = (ev) => {
            ev.preventDefault();  //stops the form submitting
            let question = document.getElementById('questionBox').value
            questions.push(question);
            // to clear the form for the next entries
            document.querySelector('form').reset();

            //this is for display purposes to make sure the text is diplayed as an object
            console.warn('added', { questions });
            let pre = document.querySelector('#msg pre');
            pre.textContent = JSON.stringify(questions);

            // get input from the question box
            var list = question;

            // start a html table
            var table = document.getElementsByTagName('table')[0];

            // add a row to the table
            var newRow = table.insertRow(table.rows.length);

            // add cells to the row
            var cell = newRow.insertCell(0);

            // add text values to the cells
            cell.innerHTML = list;

            // increment counter
            counter++;

            // if user sends 5 questions, disable button so no more can be sent
            if (counter == 5) {
                document.getElementById("btn").disabled = true;
                document.getElementById("msg").innerHTML = "You have entered five questions - your survey has been saved!";
                SendQuestions(questions[0], questions[1], questions[2], questions[3], questions[4]);
            }

        }
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('btn').addEventListener('click', addQuestion);
        });
        //end of hhinker script for question page code

    </script>
    <!--END OF YOUR OWN JAVASCRIPT-->
    <!--AND YOUR OWN CSS CAN GO HERE AS WELL-->
    <style>
    </style>
    <!--END OF YOUR OWN CSS-->
</head>

<body>

    <!--hhinker BEGIN question page html-->
    <header>
        <button type="button" onclick="window.location.href='logoff.html'">Log Off</button>
    </header>

    <h1>Pascal Questions</h1>

    <form>
        <section id="question">
            <label>Please enter five questions to be asked in your survey:</label><br>
            <textarea id="questionBox" name="questionBox" placeholder="Enter Question Here"></textarea>
        </section>

        <div>
            <button id="btn">Submit</button>
            <button type="reset"> Reset</button>
        </div>
        <div id="msg">
            <pre>
                
            </pre>
        </div>

    </form>

    <table border="1">

        <tr>
            <th id="qList">List of Questions</th>

        </tr>

    </table>

    <!--hhinker END question page html-->

</body>

</html>
